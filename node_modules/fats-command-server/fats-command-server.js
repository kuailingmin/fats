/*
 * fats server command
 * */
exports.name = 'server';
exports.usage = '<command> [options]';
exports.desc = 'launch a Node.js server';
exports.register = function (commander) {

	var serverRoot = process.cwd();

	commander
		.option('-w, --watch <switch>', 'include trunk and branches directory', String, 'on')
		.option('-r, --root <root>', 'document root', String, serverRoot)
		.option('-p, --port <port>', 'server listen port', parseInt, 8080)
		.action(function () {

			var args = Array.prototype.slice.call(arguments);
			var options = args.pop();
			var cmd = args.shift();

			var port = options.port;
			var watch = options.watch;
			var root = options.root || serverRoot;

			console.log('cmd: ' + cmd);
			console.log('serverRoot: ' + root);
			console.log('watch: ' + watch);
			console.log('port: ' + port);

		}).on('--help', function () {
			console.log('  Examples:');
			console.log('');
			console.log('    $ fats server start');
			console.log('    $ fats server start -w off');
			console.log('    $ fats server stop');
			console.log('');
		});

	commander
		.command('start')
		.description('start server');

	commander
		.command('stop')
		.description('shutdown server');

	commander
		.command('restart')
		.description('restart server');

	commander
		.command('open')
		.description('open document root directory');
};