/*
 * fats server command
 * */
exports.name = 'server';
exports.usage = '<command> [options]';
exports.desc = 'launch a web server';
exports.register = function (commander) {

	var serverRoot = process.cwd();

	commander
		.option('-w, --watch <switch>', 'on/off, ', String, 'on')
		.option('-r, --root <root>', 'document root', String, serverRoot)
		.option('-p, --port <port>', 'server listen port', 3000)
		.action(function () {

			var args = Array.prototype.slice.call(arguments);
			var options = args.pop();
			var cmd = args.shift();
			var root = options.root || serverRoot;

			console.log(options);

			switch (cmd) {
				case 'start':
					console.log(cmd);
					break;

				case 'restart':
					console.log(cmd);
					break;

				case 'stop':
					console.log(cmd);
					break;

				case 'stopAll':
					console.log(cmd);
					break;

				case 'list':
					console.log(cmd);
					break;

				default:
					commander.help();
					return;

			}

			var port = parseInt(options.port);
			var watch = options.watch;

			console.log('cmd: ' + cmd);
			console.log('serverRoot: ' + root);
			console.log('watch: ' + watch);
			console.log('port: ' + port);

		}).on('--help', function () {
			console.log('  Examples:');
			console.log('');
			console.log('    $ fats server start');
			console.log('    $ fats server start -w off -p 3000');
			console.log('    $ fats server stop');
			console.log('');
		});

	commander
		.command('start')
		.description('start server');

	commander
		.command('stop')
		.description('shutdown server');

	commander
		.command('restart')
		.description('restart server');

	commander
		.command('open')
		.description('open document root directory');
};