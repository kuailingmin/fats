module.exports = function () {

	var plugins = [
		'uglify',
		'cssminfy',
		'clean-css',
		'csslint',
		'jslint'
	];

	var fats = this;
	var taskConfig = this.taskConfig;
	var env = taskConfig.env;
	var taskList = taskConfig.taskList;
//	console.log(taskConfig.fats.template.today('UTC:YYYY-MM-DD hh:mm:ss'));
//	console.log(taskConfig.fats.template.today('YYYY-MM-DD hh:mm:ss'));
//	console.log(taskConfig.fats.template.today('YYYY.MM.DD'));
//	console.log(env);
//	console.log(taskList);
//	console.log(taskConfig);


	for (var key in taskList) {

		// 注册任务名称，合法的则执行，不合法的则直接抛弃
		if (!fats.util.inArray(key, plugins)) {
			continue;
		}
		console.log(key);

		var task = taskList[key];
		for (var subKey in task) {

			var subTask = task[subKey];
			var subOptions = subTask.options;
			if ('undefined' != typeof subOptions) {

				// parse banner
				if ('undefined' != typeof subOptions.banner) {
					var banner = subOptions.banner;
					banner = banner.replace(/<%=\s?(.*?)\s?%>/g, function (match, key) {
						try {
							if (/^fats\./.test(key)) {
								return eval('taskConfig.' + key);
							} else {
								return eval('taskConfig.taskList.' + key)
							}
						} catch (e) {
							return key;
						}

					});
					subTask.options.bannerParsed = banner;
//					console.log(banner);
				}

			}
		}

	}

//	console.log(taskList.uglify);

};